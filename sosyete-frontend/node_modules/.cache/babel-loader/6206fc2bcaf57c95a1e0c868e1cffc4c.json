{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute, Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\n\nvar DragAndDrop =\n/** @class */\nfunction (_super) {\n  __extends(DragAndDrop, _super);\n\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    return _this;\n  }\n\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    var dragObj = new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.parent.eventDragArea ? document.querySelector(this.parent.eventDragArea) : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n\n    if (!(dragObj.enableTapHold && Browser.isDevice && Browser.isTouch)) {\n      EventHandler.remove(element, 'touchstart', dragObj.initialize);\n    }\n  };\n\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n\n      _this.actionObj.cloneElement.push(cloneElement);\n\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    var topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        _this.actionObj.action = '';\n\n        _this.removeCloneElementClasses();\n\n        _this.removeCloneElement();\n\n        return;\n      }\n\n      _this.actionClass('addClass');\n\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n\n        _this.updateOriginalElement(_this.actionObj.clone);\n\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n      }\n    });\n  };\n\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  };\n\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(events.drag, dragArgs);\n  };\n\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n\n              _this.viewNavigation(e);\n\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!tarWrapper_1) {\n        tarWrapper_1 = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        outWrapper.appendChild(tarWrapper_1);\n      }\n\n      this.actionObj.cloneElement.forEach(function (ele) {\n        tarWrapper_1.appendChild(ele);\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  };\n\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    var index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    var td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    var dragStart;\n    var dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  };\n\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n\n    for (var i = 0; i < this.actionObj.groupIndex; i++) {\n      datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n    }\n\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[this.actionObj.groupIndex], util.resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var record = this.verticalEvent.isSpannedEvent(event, dayIndex, this.actionObj.groupIndex);\n      var eStart = record[this.verticalEvent.fields.startTime];\n      var eEnd = record[this.verticalEvent.fields.endTime];\n      var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n      var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, this.actionObj.groupIndex) : this.actionObj.element.offsetTop;\n\n      if (isNullOrUndefined(index)) {\n        this.actionObj.clone.style.top = formatUnit(topValue);\n        this.actionObj.clone.style.height = formatUnit(appHeight);\n      } else {\n        var appWidth = this.actionObj.cellWidth;\n\n        if (event[this.parent.eventFields.isAllDay]) {\n          topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n          appHeight = this.getAllDayEventHeight();\n          var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n          var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n          if (allDayDifference >= 0) {\n            appWidth = allDayDifference * this.actionObj.cellWidth;\n          }\n        }\n\n        if (this.actionObj.cloneElement[index]) {\n          this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n          this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n          this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n          this.actionObj.cloneElement[index].style.left = formatUnit(0);\n        }\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    var _this = this;\n\n    var _a, _b;\n\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.parent.activeView.renderDates;\n\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    this.removeCloneElement();\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n        eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_1 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_1[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_1[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_1[0], eventData); // eslint-disable-next-line max-len\n\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  };\n\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  };\n\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  };\n\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - window.scrollY) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].offsetTop;\n\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  };\n\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n\n    if (this.parent.eventDragArea) {\n      document.querySelector(this.parent.eventDragArea).appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  };\n\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n\n\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n\n  return DragAndDrop;\n}(ActionBase);\n\nexport { DragAndDrop };","map":{"version":3,"sources":["/Users/ozigun1988/Desktop/Sosyete/sosyete-frontend/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","Browser","EventHandler","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","wireDragEvent","element","dragObj","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","parent","isAdaptive","enableTailMode","eventDragArea","cursorAt","left","top","dragArea","document","querySelector","CONTENT_TABLE_CLASS","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","isDevice","isTouch","initialize","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","Math","ceil","offsetWidth","cellWidth","enableRtl","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","CONTENT_WRAP_CLASS","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","pageX","abs","getBoundingClientRect","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","group","resources","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","wrapper","updateEventHeight","parentNode","updateTimePosition","timeDifference","endTimeDiff","differInDays","day","query","DAY_WRAPPER_CLASS","initializeValues","datesCount","i","getIndexOfDate","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","appWidth","timeDiff","allDayDifference","endDate","_b","slots","map","filter","res","splitEvent","concat","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","CLONE_ELEMENT_CLASS","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","eventsData","dataIndex","events_1","eventData","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","targetDate","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute, Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        var dragObj = new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: (this.parent.eventDragArea) ?\n                document.querySelector(this.parent.eventDragArea) :\n                this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n        if (!(dragObj.enableTapHold && Browser.isDevice && Browser.isTouch)) {\n            EventHandler.remove(element, 'touchstart', dragObj.initialize);\n        }\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!tarWrapper_1) {\n                tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                outWrapper.appendChild(tarWrapper_1);\n            }\n            this.actionObj.cloneElement.forEach(function (ele) {\n                tarWrapper_1.appendChild(ele);\n            });\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        var index;\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n                if (dayIndex >= 0) {\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n                        remove(this.actionObj.cloneElement[index_1]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = 0;\n        for (var i = 0; i < this.actionObj.groupIndex; i++) {\n            datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n        }\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[this.actionObj.groupIndex], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var record = this.verticalEvent.isSpannedEvent(event, dayIndex, this.actionObj.groupIndex);\n            var eStart = record[this.verticalEvent.fields.startTime];\n            var eEnd = record[this.verticalEvent.fields.endTime];\n            var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                this.actionObj.element.offsetHeight;\n            var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                this.verticalEvent.getTopValue(eStart, dayIndex, this.actionObj.groupIndex) : this.actionObj.element.offsetTop;\n            if (isNullOrUndefined(index)) {\n                this.actionObj.clone.style.top = formatUnit(topValue);\n                this.actionObj.clone.style.height = formatUnit(appHeight);\n            }\n            else {\n                var appWidth = this.actionObj.cellWidth;\n                if (event[this.parent.eventFields.isAllDay]) {\n                    topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                    appHeight = this.getAllDayEventHeight();\n                    var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                        event[this.parent.eventFields.startTime].getTime();\n                    var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                    if (allDayDifference >= 0) {\n                        appWidth = (allDayDifference * this.actionObj.cellWidth);\n                    }\n                }\n                if (this.actionObj.cloneElement[index]) {\n                    this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                    this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                    this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                    this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        var _this = this;\n        var _a, _b;\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        this.removeCloneElement();\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var dragEnd = new Date(dragStart.getTime());\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n            var wrapper = eventWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            eventStart.setMinutes(eventStart.getMinutes() -\n                (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var events_1 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            var eventData = events_1[0].data;\n            var startTime = this.timelineEventModule.getStartTime(events_1[0], eventData);\n            var endTime = this.timelineEventModule.getEndTime(events_1[0], eventData);\n            // eslint-disable-next-line max-len\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[index].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y + (dragArea.scrollTop - translateY - window.scrollY)) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        var top = trCollection[rowIndex].offsetTop;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        if (this.parent.eventDragArea) {\n            document.querySelector(this.parent.eventDragArea).appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"]},"metadata":{},"sourceType":"module"}